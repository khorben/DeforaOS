subdirs=arch,format
targets=libas,as,disas
cppflags_force=-I ../include
cppflags=
cflags_force=-W `pkg-config --cflags cpp`
cflags=-Wall -g -O2 -pedantic
ldflags_force=-ldl
dist=Makefile,arch.h,as.h,code.h,common.h,format.h,parser.h,token.h

[libas]
type=library
sources=arch.c,as.c,code.c,format.c,parser.c,token.c
cflags=-fPIC
ldflags=`pkg-config --libs cpp`
install=$(LIBDIR)

[as]
type=binary
sources=main.c
depends=libas.so
ldflags=-L. -Wl,-rpath,$(LIBDIR) -las
install=$(BINDIR)

[disas]
type=binary
sources=disas.c
depends=libas.so
ldflags=-L. -Wl,-rpath,$(LIBDIR) -las
install=$(BINDIR)

[arch.c]
depends=arch.h,../config.h

[as.c]
depends=../include/As.h,as.h,../config.h

[code.c]
depends=../include/As.h,arch.h,code.h

[disas.c]
depends=../include/As.h

[format.c]
depends=format.h

[main.c]
depends=../include/As.h

[parser.c]
depends=parser.h

[scanner.c]
depends=../include/As.h,token.h

[token.c]
depends=token.h
