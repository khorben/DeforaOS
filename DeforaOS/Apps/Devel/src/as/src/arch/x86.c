/* x86.c */



#include <stddef.h>
#include "arch.h"


/* variables */
ArchInstruction arch_x86_set[] =
{
	{ "adc",	0x0010, 2 },
	{ "adc",	0x0011, 2 },
	{ "adc",	0x0012, 2 },
	{ "adc",	0x0013, 2 },
	{ "adc",	0x0014, 2 },
	{ "adc",	0x0015, 2 },
	{ "add",	0x0000, 2 },
	{ "add",	0x0001, 2 },
	{ "add",	0x0002, 2 },
	{ "add",	0x0003, 2 },
	{ "add",	0x0004, 2 },
	{ "add",	0x0005, 2 },
	{ "and",	0x0020, 2 },
	{ "and",	0x0021, 2 },
	{ "and",	0x0022, 2 },
	{ "and",	0x0023, 2 },
	{ "and",	0x0024, 2 },
	{ "and",	0x0025, 2 },
	{ "call",	0x00e8, 1 },
	{ "clc",	0x00f8, 0 },
	{ "cld",	0x00fc, 0 },
	{ "cli",	0x00fa, 0 },
	{ "cmc",	0x00f5, 0 },
	{ "dec",	0x0048, 1 },
	{ "dec",	0x0049, 1 },
	{ "dec",	0x004a, 1 },
	{ "dec",	0x004b, 1 },
	{ "dec",	0x004c, 1 },
	{ "dec",	0x004d, 1 },
	{ "dec",	0x004e, 1 },
	{ "dec",	0x004f, 1 },
	{ "hlt",	0x00f4, 0 },
	{ "inc",	0x0040, 1 },
	{ "inc",	0x0041, 1 },
	{ "inc",	0x0042, 1 },
	{ "inc",	0x0043, 1 },
	{ "inc",	0x0044, 1 },
	{ "inc",	0x0045, 1 },
	{ "inc",	0x0046, 1 },
	{ "inc",	0x0047, 1 },
	{ "jb",		0x0072, 1 },
	{ "jmp",	0x00e9, 1 },
	{ "jmp",	0x00ea, 1 },
	{ "jmp",	0x00eb, 1 },
	{ "jnb",	0x0073, 1 },
	{ "jno",	0x0071, 1 },
	{ "jnz",	0x0075, 1 },
	{ "jnbe",	0x0077, 1 },
	{ "jo",		0x0070, 1 },
	{ "jz",		0x0074, 1 },
	{ "jbe",	0x0076, 1 },
	{ "lea",	0x008d, 2 },
	{ "mov",	0x0088, 2 },
	{ "mov",	0x0089, 2 },
	{ "mov",	0x008a, 2 },
	{ "mov",	0x008b, 2 },
	{ "mov",	0x00b8, 2 },
	{ "mov",	0x00b9, 2 },
	{ "mov",	0x00ba, 2 },
	{ "mov",	0x00bb, 2 },
	{ "mov",	0x00bc, 2 },
	{ "mov",	0x00bd, 2 },
	{ "mov",	0x00be, 2 },
	{ "mov",	0x00bf, 2 },
	{ "nop",	0x0090, 0 },
	{ "pop",	0x0007, 1 },
	{ "pop",	0x0017, 1 },
	{ "pop",	0x0058, 1 },
	{ "pop",	0x0059, 1 },
	{ "pop",	0x005a, 1 },
	{ "pop",	0x005b, 1 },
	{ "pop",	0x005c, 1 },
	{ "pop",	0x005d, 1 },
	{ "pop",	0x005e, 1 },
	{ "pop",	0x005f, 1 },
	{ "popa",	0x0061, 0 },
	{ "push",	0x0006, 1 },
	{ "push",	0x0016, 1 },
	{ "push",	0x0050, 1 },
	{ "push",	0x0051, 1 },
	{ "push",	0x0052, 1 },
	{ "push",	0x0053, 1 },
	{ "push",	0x0054, 1 },
	{ "push",	0x0055, 1 },
	{ "push",	0x0056, 1 },
	{ "push",	0x0057, 1 },
	{ "pusha",	0x0060, 0 },
	{ "stc",	0x00f9, 0 },
	{ "std",	0x00fd, 0 },
	{ "sti",	0x00fb, 0 },
	{ "sbb",	0x0018, 2 },
	{ "sbb",	0x0019, 2 },
	{ "sbb",	0x001a, 2 },
	{ "sbb",	0x001b, 2 },
	{ "sbb",	0x001c, 2 },
	{ "sbb",	0x001d, 2 },
	{ "sub",	0x0028, 2 },
	{ "sub",	0x0029, 2 },
	{ "sub",	0x002a, 2 },
	{ "sub",	0x002b, 2 },
	{ "sub",	0x002c, 2 },
	{ "sub",	0x002d, 2 },
	{ "test",	0x00a8, 2 },
	{ "test",	0x00a9, 2 },
	{ "xor",	0x0030, 2 },
	{ "xor",	0x0031, 2 },
	{ "xor",	0x0032, 2 },
	{ "xor",	0x0033, 2 },
	{ "xor",	0x0034, 2 },
	{ "xor",	0x0035, 2 },
	{ NULL,		0x0000, 0 }
};

ArchRegister arch_x86_regs[] =
{
	{ "eax",	32 },
	{ "ax",		16 },
	{ "ah",		8 },
	{ "al",		8 },
	{ "ebx",	32 },
	{ "bx",		16 },
	{ "bh",		8 },
	{ "bl",		8 },
	{ "ecx",	32 },
	{ "cx",		16 },
	{ "ch",		8 },
	{ "cl",		8 },
	{ "edx",	32 },
	{ "dx",		16 },
	{ "dh",		8 },
	{ "dl",		8 },
	{ "esp",	32 },
	{ "sp",		16 },
	{ "ebp",	32 },
	{ "bp",		16 },
	{ "esi",	32 },
	{ "si",		16 },
	{ "edi",	32 },
	{ "di",		16 },
};

ArchPlugin arch_plugin =
{
	arch_x86_set,
	arch_x86_regs
};
